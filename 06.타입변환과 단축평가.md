# 타입변환과 단축평가

## 타입변환
- 명시적 타입변환 explicit coercion, 타입캐스팅 typecasting
의도적으로 값의타입을 변환
- 암묵적 타입변환 implicit coercion, 타입강제변환 type coercion
자바스크립트 엔진에의해 자동변환
- 기존 원시값을 직접 변경하는것이 아닌 새로운 원시값을 생성하는것이다.
- 특히 암묵적 타입변환은 재할당이아닌 새로운 타입값을 만든후 사용후 바로 버린다.

## 암묵적 타입변환
암묵적 타입변환이 꼭 나쁜것은아니지만, 가독성을 생각해 잘 사용해야함

- 문자열타입으로 변환
```
숫자 타입
0 + ''         // -> "0"
-0 + ''        // -> "0"
1 + ''         // -> "1"
-1 + ''        // -> "-1"
NaN + ''       // -> "NaN"
Infinity + ''  // -> "Infinity"
-Infinity + '' // -> "-Infinity"
```
```
불리언 타입
true + ''  // -> "true"
false + '' // -> "false"
```
```
null 타입
null + '' // -> "null"
```
```
undefined 타입
undefined + '' // -> "undefined"
```
```
심벌 타입
(Symbol()) + '' // -> TypeError: Cannot convert a Symbol value to a string
```
```
객체 타입
({}) + ''           // -> "[object Object]"
Math + ''           // -> "[object Math]"
[] + ''             // -> ""
[10, 20] + ''       // -> "10,20"
(function(){}) + '' // -> "function(){}"
Array + ''          // -> "function Array() { [native code] }"
```

- 숫자열 타입으로 변환

빈문자열, 빈배열, null, false는 0으로/ true는 1로 / 객체와 비어있지않은배열,undefined는 NaN 으로 되는것을 기억하자.
```
문자열 타입
+''       // -> 0
+'0'      // -> 0
+'1'      // -> 1
+'string' // -> NaN
```
```
불리언 타입
+true     // -> 1
+false    // -> 0
```
```
null 타입
+null     // -> 0
```
```
undefined 타입
+undefined // -> NaN
```
```
심벌 타입
+Symbol() // -> ypeError: Cannot convert a Symbol value to a number
```
```
객체 타입
+{}             // -> NaN
+[]             // -> 0
+[10, 20]       // -> NaN
+(function(){}) // -> NaN
```

- 불리언타입으로 변환

조건식은 불리언값이여야하므로 Truthy값(true로 평가되는 값) 또는 Falsy값(false로 평가되는 값)으로 구분한다. 
```
false, undefined, null, 0, -0, NaN, 빈문자열은 Falsy
Falsy가 아닌 나머지는모두  Truthy로 평가된다
```

## 명시적 타입변환
- 문자열 타입변환
```
String 생성자 함수를 new 연산자 없이 호출

숫자 타입 => 문자열 타입
String(1);        // -> "1"
String(NaN);      // -> "NaN"
String(Infinity); // -> "Infinity"

불리언 타입 => 문자열 타입
String(true);     // -> "true"
String(false);    // -> "false"
```
```
Object.prototype.toString 메서드를 사용

숫자 타입 => 문자열 타입
(1).toString();        // -> "1"
(NaN).toString();      // -> "NaN"
(Infinity).toString(); // -> "Infinity"

불리언 타입 => 문자열 타입
(true).toString();     // -> "true"
(false).toString();    // -> "false"
```
```
문자열 연결 연산자를 이용

숫자 타입 => 문자열 타입
1 + '';        // -> "1"
NaN + '';      // -> "NaN"
Infinity + ''; // -> "Infinity"

불리언 타입 => 문자열 타입
true + '';     // -> "true"
false + '';    // -> "false"
```
- 숫자열 타입으로 변환
```
Number 생성자 함수를 new 연산자 없이 호출

문자열 타입 => 숫자 타입
Number('0');     // -> 0
Number('-1');    // -> -1
Number('10.53'); // -> 10.53

불리언 타입 => 숫자 타입
Number(true);    // -> 1
Number(false);   // -> 0
```
```
parseInt, parseFloat 함수를 사용(문자열만 변환 가능)

문자열 타입 => 숫자 타입
parseInt('0');       // -> 0
parseInt('-1');      // -> -1
parseFloat('10.53'); // -> 10.53
```
```
+ 단항 산술 연산자를 이용

문자열 타입 => 숫자 타입
+'0';     // -> 0
+'-1';    // -> -1
+'10.53'; // -> 10.53

불리언 타입 => 숫자 타입
+true;    // -> 1
+false;   // -> 0
```
```
* 산술 연산자를 이용

문자열 타입 => 숫자 타입
'0' * 1;     // -> 0
'-1' * 1;    // -> -1
'10.53' * 1; // -> 10.53

불리언 타입 => 숫자 타입
true * 1;    // -> 1
false * 1;   // -> 0
```
- 불리언타입으로 변환
```
Boolean 생성자 함수를 new 연산자 없이 호출

문자열 타입 => 불리언 타입
Boolean('x');       // -> true
Boolean('');        // -> false
Boolean('false');   // -> true

숫자 타입 => 불리언 타입
Boolean(0);         // -> false
Boolean(1);         // -> true
Boolean(NaN);       // -> false
Boolean(Infinity);  // -> true

null 타입 => 불리언 타입
Boolean(null);      // -> false
undefined 타입 => 불리언 타입
Boolean(undefined); // -> false

객체 타입 => 불리언 타입
Boolean({});        // -> true
Boolean([]);        // -> true
```
```
! 부정 논리 연산자를 두번 사용

문자열 타입 => 불리언 타입
!!'x';       // -> true
!!'';        // -> false
!!'false';   // -> true

숫자 타입 => 불리언 타입
!!0;         // -> false
!!1;         // -> true
!!NaN;       // -> false
!!Infinity;  // -> true

null 타입 => 불리언 타입
!!null;      // -> false
undefined 타입 => 불리언 타입
!!undefined; // -> false

객체 타입 => 불리언 타입
!!{};        // -> true
!![];        // -> true
```

## 단축평가 short-circuit evaluation
- 논리연산의 결과를 결정하는 피연산자를 타입변환없이 그대로 반환하며, 표현식을 평가하는 중 평가결과가 확정된다면 나머지 평가과정은 생략한다.

- 논리곱 연산은 좌에서 우로 평가되며, 피연산자가 모두 true라면 두번째피연산자를 그대로 반환한다.
- 논리합 연산도 좌에서 우로 평가되며, 피연산자중 하나만 true라도 true를 반환하기때문에 첫번째 피연산자가 true라면 첫번째 피연산자를 바로 반환한다. 첫째가 false고 둘째가 true라면 둘째를 반환
```
'Cat' && 'Dog' // -> "Dog"
'Cat' || 'Dog' // -> "Cat"
```
### if문의 대체가능
- 조건이 Truthy값일때 무언가를 해야한다면-> 논리곱연산자표현식(&&)
- 조건이 Falsy값일때 무언가를 해야한다면-> 논리합연산자표현식(||)
- 삼항조건연산자도 if..else문을 대체할 수 있다
```
var done = true;
var message = '';

if...else 문
if (done) message = '완료';
else      message = '미완료';
console.log(message); // 완료

if...else 문은 삼항 조건 연산자로 대체 가능하다.
message = done ? '완료' : '미완료';
console.log(message); // 완료
```
### 단축평가의 활용
- 변수가 객체가아닌 null 이나 undefined를 참조하면타입에러가 발생하며 프로그램이 강제종료되고, 이떄 단축평가를 사용하면 에러가 발생하지않는다.
```
var elem = null;
var value = elem.value; // TypeError: Cannot read property 'value' of null

이것을 단축평가하면?

var elem = null;
// elem이 null이나 undefined와 같은 Falsy 값이면 elem으로 평가되고
// elem이 Truthy 값이면 elem.value로 평가된다.
var value = elem && elem.value; // -> null
```

- 함수를 호출할때 인수를 전달하지않으면 매개변수는 기본적으로 undefined를 가지는데, 이때 단축평가를 사용하여 매개변수의 기본값을 설정하면 오류안뜸
```
단축 평가를 사용한 매개변수의 기본값 설정
function getStringLength(str) {
  str = str || '';
  return str.length;
}

getStringLength();     // -> 0
getStringLength('hi'); // -> 2
```

## 옵셔널체이닝 연산자 ?.  optional chaining
-  좌항의 피연산자가 null 또는 undefined인 경우 undefined를 반환하고, 그렇지 않으면 우항의 프로퍼티 참조를 이어간다
```
변수를 통해 변수값을 참조하듯이 객체의 프로퍼티에 접근해 프로퍼티 값을 참조하는 것을 '프로퍼티 참조' 라고 한다.
```
```
var str = '';

문자열의 길이(length)를 참조한다. 이때 좌항 피연산자가 false로 평가되는 Falsy 값이라도
null 또는 undefined가 아니면 우항의 프로퍼티 참조를 이어간다.
var length = str?.length;
console.log(length); // 0
```

## null 병합 연산자 ??
- 좌항의 피연산자가 null 또는 undefined인 경우 우항의 피연산자를 반환, 그렇지 않으면 좌항의 피연산자를 반환
```
좌항의 피연산자가 null 또는 undefined이면 우항의 피연산자를 반환하고, 그렇지 않으면 좌항의 피연산자를 반환한다.
var foo = null ?? 'default string';
console.log(foo); // "default string"
```
- 이는 변수에 기본값을 설정할때 유용하다.
```
논리연산자 ||를 사용하면

Falsy 값인 0이나 ''도 기본값으로서 유효하다면 예기치 않은 동작이 발생할 수 있다.
var foo = '' || 'default string';
console.log(foo); // "default string"
```
```
null 병합연산자를 사용하면

좌항의 피연산자가 Falsy 값이라도 null 또는 undefined이 아니면 좌항의 피연산자를 반환한다.
var foo = '' ?? 'default string';
console.log(foo); // ""
``` 
